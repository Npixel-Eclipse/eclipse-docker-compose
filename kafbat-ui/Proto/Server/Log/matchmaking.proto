syntax = "proto3";
package log;

option java_multiple_files = true;
option java_package = "eclipse.proto.server.log";
option java_outer_classname = "MatchmakingLogServiceProto";

// matching: 매칭 행위 자체를 의미
// match: 매치가 된 전장을 의미

message TryMatching {
  int64 matchmaking_id = 1;
  int64 dungeon_id = 2;
  int64 matching_rate = 3;
}

message SucceedMatching {
  int64 matchmaking_id = 1;
  int64 dungeon_id = 2;
  int64 matching_rate = 3;
}

message JoinMatching {
  int64 matchmaking_id = 1;
  int64 dungeon_id = 2;
  string match_uuid = 3;
  int64 team_id = 4;
  int64 matching_rate = 5;
}

message StartMatch {
  message Team {
    int64 team_id = 1;
    int64 player_count = 2;
  }

  int64 matchmaking_id = 1;
  int64 dungeon_id = 2;
  string match_uuid = 3;
  repeated Team teams = 4;
}

message DeleteMatch {
  enum Reason {
    FINISH = 0;
    UNKNOWN = 1;
  }

  enum Result {
    WIN = 0;
    LOSE = 1;
    DRAW = 2;
    PENALTY = 3;
  }

  message Team {
    int64 team_id = 1;
    int64 score = 2;
    Result result = 3;
  }

  message Player {
    int64 team_id = 1;
    int64 account_id = 2;
    string character_uuid = 3;
    repeated Property scores = 4;
    Result result = 5;
  }

  message Property {
    string key = 1;
    int64 value = 2;
  }

  int64 matchmaking_id = 1;
  int64 dungeon_id = 2;
  string match_uuid = 3;
  Reason reason = 4;
  repeated Team teams = 5;
  repeated Player players = 6;
}
